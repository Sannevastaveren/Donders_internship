<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code_documentation</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="pipeline-documentation">Pipeline Documentation</h1>
<pre class=" language-mermaid"><svg id="mermaid-svg-yUV2Ba6PpJHs4kjk" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="993.8953247070312" style="max-width: 492.6484375px;" viewBox="0 0 492.6484375 993.8953247070312"><style>#mermaid-svg-yUV2Ba6PpJHs4kjk{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-yUV2Ba6PpJHs4kjk .error-icon{fill:#552222;}#mermaid-svg-yUV2Ba6PpJHs4kjk .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-yUV2Ba6PpJHs4kjk .marker{fill:#666;stroke:#666;}#mermaid-svg-yUV2Ba6PpJHs4kjk .marker.cross{stroke:#666;}#mermaid-svg-yUV2Ba6PpJHs4kjk svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-yUV2Ba6PpJHs4kjk .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-yUV2Ba6PpJHs4kjk .cluster-label text{fill:#333;}#mermaid-svg-yUV2Ba6PpJHs4kjk .cluster-label span{color:#333;}#mermaid-svg-yUV2Ba6PpJHs4kjk .label text,#mermaid-svg-yUV2Ba6PpJHs4kjk span{fill:#000000;color:#000000;}#mermaid-svg-yUV2Ba6PpJHs4kjk .node rect,#mermaid-svg-yUV2Ba6PpJHs4kjk .node circle,#mermaid-svg-yUV2Ba6PpJHs4kjk .node ellipse,#mermaid-svg-yUV2Ba6PpJHs4kjk .node polygon,#mermaid-svg-yUV2Ba6PpJHs4kjk .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-yUV2Ba6PpJHs4kjk .node .label{text-align:center;}#mermaid-svg-yUV2Ba6PpJHs4kjk .node.clickable{cursor:pointer;}#mermaid-svg-yUV2Ba6PpJHs4kjk .arrowheadPath{fill:#333333;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-yUV2Ba6PpJHs4kjk .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-yUV2Ba6PpJHs4kjk .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-yUV2Ba6PpJHs4kjk .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-yUV2Ba6PpJHs4kjk .cluster text{fill:#333;}#mermaid-svg-yUV2Ba6PpJHs4kjk .cluster span{color:#333;}#mermaid-svg-yUV2Ba6PpJHs4kjk div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-yUV2Ba6PpJHs4kjk:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-yUV2Ba6PpJHs4kjk flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"><path class="path" d="M223.75,54.71875L223.75,79.71875L224.25000000000003,105.21875152587889" marker-end="url(https://stackedit.io/app#arrowhead5753)" style="fill:none"></path><defs><marker id="arrowhead5753" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" style="opacity: 1;" id="L-B-C"><path class="path" d="M197.3233895402399,220.92807856611887L157.22265625,285.7140655517578L157.22265625,347.4328155517578L157.22265625,395.7921905517578L194.12268875074167,451.4195048527739" marker-end="url(https://stackedit.io/app#arrowhead5754)" style="fill:none"></path><defs><marker id="arrowhead5754" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-D" style="opacity: 1;" id="L-B-D"><path class="path" d="M251.17660930754707,220.928076666574L290.27734375,285.7140655517578L290.27734375,324.0734405517578" marker-end="url(https://stackedit.io/app#arrowhead5755)" style="fill:none"></path><defs><marker id="arrowhead5755" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-C" style="opacity: 1;" id="L-D-C"><path class="path" d="M290.27734375,370.7921905517578L290.27734375,395.7921905517578L254.3773136766002,451.41950117660025" marker-end="url(https://stackedit.io/app#arrowhead5756)" style="fill:none"></path><defs><marker id="arrowhead5756" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-E" style="opacity: 1;" id="L-C-E"><path class="path" d="M224.24999999999997,572.8015624999999L223.75,610.6609344482422L223.75,649.0203094482422" marker-end="url(https://stackedit.io/app#arrowhead5757)" style="fill:none"></path><defs><marker id="arrowhead5757" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-G2" style="opacity: 1;" id="L-C-G2"><path class="path" d="M271.0515806579814,525.999987945534L408.2109375,610.6609344482422L408.2109375,649.0203094482422" marker-end="url(https://stackedit.io/app#arrowhead5758)" style="fill:none"></path><defs><marker id="arrowhead5758" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-J" style="opacity: 1;" id="L-C-J"><path class="path" d="M181.3749569270282,529.9265194270282L74.9453125,610.6609344482422L74.9453125,672.3796844482422L74.9453125,720.7390594482422L74.9453125,769.0984344482422L74.9453125,817.4578094482422L74.9453125,865.8171844482422L74.9453125,914.1765594482422L200,954.8175273500115" marker-end="url(https://stackedit.io/app#arrowhead5759)" style="fill:none"></path><defs><marker id="arrowhead5759" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G2 LE-F" style="opacity: 1;" id="L-G2-F"><path class="path" d="M408.2109375,695.7390594482422L408.2109375,720.7390594482422L408.2109375,745.7390594482422" marker-end="url(https://stackedit.io/app#arrowhead5760)" style="fill:none"></path><defs><marker id="arrowhead5760" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-G1" style="opacity: 1;" id="L-E-G1"><path class="path" d="M223.75,695.7390594482422L223.75,720.7390594482422L223.75,745.7390594482422" marker-end="url(https://stackedit.io/app#arrowhead5761)" style="fill:none"></path><defs><marker id="arrowhead5761" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G1 LE-H" style="opacity: 1;" id="L-G1-H"><path class="path" d="M223.75,792.4578094482422L223.75,817.4578094482422L223.75,842.4578094482422" marker-end="url(https://stackedit.io/app#arrowhead5762)" style="fill:none"></path><defs><marker id="arrowhead5762" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-I" style="opacity: 1;" id="L-F-I"><path class="path" d="M408.2109375,792.4578094482422L408.2109375,817.4578094482422L408.2109375,842.4578094482422" marker-end="url(https://stackedit.io/app#arrowhead5763)" style="fill:none"></path><defs><marker id="arrowhead5763" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-J" style="opacity: 1;" id="L-H-J"><path class="path" d="M223.75,889.1765594482422L223.75,914.1765594482422L223.75,939.1765594482422" marker-end="url(https://stackedit.io/app#arrowhead5764)" style="fill:none"></path><defs><marker id="arrowhead5764" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-J" style="opacity: 1;" id="L-I-J"><path class="path" d="M408.2109375,889.1765594482422L408.2109375,914.1765594482422L247.5,956.3094933826371" marker-end="url(https://stackedit.io/app#arrowhead5765)" style="fill:none"></path><defs><marker id="arrowhead5765" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(157.22265625,347.4328155517578)"><g transform="translate(-11.546875,-13.359375)" class="label"><rect rx="0" ry="0" width="23.09375" height="26.71875"></rect><foreignObject width="23.09375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-C" class="edgeLabel L-LS-B' L-LE-C">yes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(290.27734375,285.7140655517578)"><g transform="translate(-8.6640625,-13.359375)" class="label"><rect rx="0" ry="0" width="17.328125" height="26.71875"></rect><foreignObject width="17.328125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-D" class="edgeLabel L-LS-B' L-LE-D">no</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-C" class="edgeLabel L-LS-D' L-LE-C"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(223.75,610.6609344482422)"><g transform="translate(-25.921875,-13.359375)" class="label"><rect rx="0" ry="0" width="51.84375" height="26.71875"></rect><foreignObject width="51.84375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-E" class="edgeLabel L-LS-C' L-LE-E">one rat</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(408.2109375,610.6609344482422)"><g transform="translate(-29.5546875,-13.359375)" class="label"><rect rx="0" ry="0" width="59.109375" height="26.71875"></rect><foreignObject width="59.109375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-G2" class="edgeLabel L-LS-C' L-LE-G2">two rats</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(74.9453125,769.0984344482422)"><g transform="translate(-66.9453125,-13.359375)" class="label"><rect rx="0" ry="0" width="133.890625" height="26.71875"></rect><foreignObject width="133.890625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-J" class="edgeLabel L-LS-C' L-LE-J">video without files</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G2-F" class="edgeLabel L-LS-G2' L-LE-F"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-G1" class="edgeLabel L-LS-E' L-LE-G1"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G1-H" class="edgeLabel L-LS-G1' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-I" class="edgeLabel L-LS-F' L-LE-I"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-J" class="edgeLabel L-LS-H' L-LE-J"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-I-J" class="edgeLabel L-LS-I' L-LE-J"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" style="opacity: 1;" id="flowchart-A-57589" transform="translate(223.75,31.359375)"><rect rx="0" ry="0" x="-55.6171875" y="-23.359375" width="111.234375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-45.6171875,-13.359375)"><foreignObject width="91.234375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Video &amp; files</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-57591" transform="translate(223.75,176.0367202758789)"><polygon points="71.31796875,0 142.6359375,-71.31796875 71.31796875,-142.6359375 0,-71.31796875" transform="translate(-71.31796875,71.31796875)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-45.8828125,-13.359375)"><foreignObject width="91.765625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Compressed?</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-57593" transform="translate(223.75,496.546875)"><polygon points="75.7546875,0 151.509375,-75.7546875 75.7546875,-151.509375 0,-75.7546875" transform="translate(-75.7546875,75.7546875)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-50.8125,-13.359375)"><foreignObject width="101.625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Type of video?</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-D-57595" transform="translate(290.27734375,347.4328155517578)"><rect rx="0" ry="0" x="-86.5078125" y="-23.359375" width="173.015625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-76.5078125,-13.359375)"><foreignObject width="153.015625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">compress down video</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-57599" transform="translate(223.75,672.3796844482422)"><rect rx="0" ry="0" x="-87.5234375" y="-23.359375" width="175.046875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-77.5234375,-13.359375)"><foreignObject width="155.046875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">sync with timestamps</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G2-57601" transform="translate(408.2109375,672.3796844482422)"><rect rx="0" ry="0" x="-46.9375" y="-23.359375" width="93.875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-36.9375,-13.359375)"><foreignObject width="73.875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">extraction</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-J-57603" transform="translate(223.75,962.5359344482422)"><rect rx="0" ry="0" x="-23.75" y="-23.359375" width="47.5" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-13.75,-13.359375)"><foreignObject width="27.5" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Exit</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-F-57605" transform="translate(408.2109375,769.0984344482422)"><rect rx="0" ry="0" x="-76.4375" y="-23.359375" width="152.875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-66.4375,-13.359375)"><foreignObject width="132.875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">synch with tracker</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G1-57607" transform="translate(223.75,769.0984344482422)"><rect rx="0" ry="0" x="-46.859375" y="-23.359375" width="93.71875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-36.859375,-13.359375)"><foreignObject width="73.71875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Extraction</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-H-57609" transform="translate(223.75,865.8171844482422)"><rect rx="0" ry="0" x="-78.5703125" y="-23.359375" width="157.140625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-68.5703125,-13.359375)"><foreignObject width="137.140625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Tracking &amp; Analysis</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-I-57611" transform="translate(408.2109375,865.8171844482422)"><rect rx="0" ry="0" x="-38.359375" y="-23.359375" width="76.71875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-28.359375,-13.359375)"><foreignObject width="56.71875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Analysis</div></foreignObject></g></g></g></g></g></g></svg></pre>
<h2 id="compression">Compression</h2>
<pre><code>import os

def  find_downsampled():
	all = []
	for root, dirs, files in os.walk("/content/drive/My Drive/Stage/"):
		for  file  in files:
			if  file.endswith(".avi"):
				if  'downsampled'  in  file:
					all.append(os.path.join(root,  file))
	return all

def  find_finished_total():
	total = 0
	finished = 0
	for root, dirs, files in os.walk("/content/drive/My Drive/Stage/"):
		for  file  in files:
			if  file.endswith(".avi"):
				if  'downsampled'  not  in  file:
					total += 1
					file_z = file.replace('.',  'downsampled.')
					if os.path.join(root, file_z)  in all:
						finished += 1
	return finished, total

def  downsample_stuff(all, finished, total):
for root, dirs, files in os.walk("/content/drive/My Drive/Stage/"):
	for  file  in files:
		if  file.endswith(".avi"):
			old_file = os.path.join(root,  file)
			already_in = False
			if  'downsampled'  not  in  file:
				file_z = file.replace('.',  'downsampled.')
				if os.path.join(root, file_z)  in all:
					already_in = True
				if already_in is  False:
					old_file = os.path.join(root,  file)
					file_l = file.split('.')
					file_l[1] = 'downsampled'
					file_l.append('.avi')
					file = ''.join(file_l)
					new_file = os.path.join(root,  file)
					!ffmpeg -i "$old_file" -filter:v scale=-1:256 -c:a copy "$new_file"
					finished += 1
					print(total,  '/', finished)
					os.remove(old_file)
					
				if already_in is  True:
					os.remove(old_file)

			  

all = find_downsampled()
finished, total = find_finished_total()
downsample_stuff(all, finished,total)
print(total,  '/', finished)
print(total,  '/',  len(all))

# everything downsampled is "done" so -- all = done
# everything not downsampled is to do -- so create list with that
# everything everything is all avi videos -- so create list with that
# total = all non downsampled videos
# all = all downsampled videos
# finished = all already downsampled videos
</code></pre>
<h2 id="synchronization">Synchronization</h2>
<h3 id="synchronization-with-timestamps">synchronization with timestamps</h3>
<pre class=" language-mermaid"><svg id="mermaid-svg-U2XK2sTEjlsUocvT" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="819.90625" style="max-width: 650.5625px;" viewBox="0 0 650.5625 819.90625"><style>#mermaid-svg-U2XK2sTEjlsUocvT{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-U2XK2sTEjlsUocvT .error-icon{fill:#552222;}#mermaid-svg-U2XK2sTEjlsUocvT .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-U2XK2sTEjlsUocvT .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-U2XK2sTEjlsUocvT .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-U2XK2sTEjlsUocvT .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-U2XK2sTEjlsUocvT .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-U2XK2sTEjlsUocvT .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-U2XK2sTEjlsUocvT .marker{fill:#666;stroke:#666;}#mermaid-svg-U2XK2sTEjlsUocvT .marker.cross{stroke:#666;}#mermaid-svg-U2XK2sTEjlsUocvT svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-U2XK2sTEjlsUocvT .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-U2XK2sTEjlsUocvT .cluster-label text{fill:#333;}#mermaid-svg-U2XK2sTEjlsUocvT .cluster-label span{color:#333;}#mermaid-svg-U2XK2sTEjlsUocvT .label text,#mermaid-svg-U2XK2sTEjlsUocvT span{fill:#000000;color:#000000;}#mermaid-svg-U2XK2sTEjlsUocvT .node rect,#mermaid-svg-U2XK2sTEjlsUocvT .node circle,#mermaid-svg-U2XK2sTEjlsUocvT .node ellipse,#mermaid-svg-U2XK2sTEjlsUocvT .node polygon,#mermaid-svg-U2XK2sTEjlsUocvT .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-U2XK2sTEjlsUocvT .node .label{text-align:center;}#mermaid-svg-U2XK2sTEjlsUocvT .node.clickable{cursor:pointer;}#mermaid-svg-U2XK2sTEjlsUocvT .arrowheadPath{fill:#333333;}#mermaid-svg-U2XK2sTEjlsUocvT .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-U2XK2sTEjlsUocvT .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-U2XK2sTEjlsUocvT .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-U2XK2sTEjlsUocvT .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-U2XK2sTEjlsUocvT .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-U2XK2sTEjlsUocvT .cluster text{fill:#333;}#mermaid-svg-U2XK2sTEjlsUocvT .cluster span{color:#333;}#mermaid-svg-U2XK2sTEjlsUocvT div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-U2XK2sTEjlsUocvT:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-U2XK2sTEjlsUocvT flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-D" style="opacity: 1;" id="L-A-D"><path class="path" d="M212.5990903225563,48.24972584902804L37.953125,79.71875L37.953125,128.078125L37.953125,176.4375L37.953125,224.796875L37.953125,286.515625L37.953125,348.234375L37.953125,396.59375L37.953125,444.953125L37.953125,506.671875L37.953125,568.390625L37.953125,630.109375L37.953125,668.46875" marker-end="url(https://stackedit.io/app#arrowhead5766)" style="fill:none"></path><defs><marker id="arrowhead5766" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-E" style="opacity: 1;" id="L-A-E"><path class="path" d="M359.73405947092084,55.21875L421.1484375,79.71875L421.6484375,105.21875000000003" marker-end="url(https://stackedit.io/app#arrowhead5767)" style="fill:none"></path><defs><marker id="arrowhead5767" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-B" style="opacity: 1;" id="L-E-B"><path class="path" d="M334.1319163974151,151.93749999999997L239.96875,176.4375L239.96875,201.4375" marker-end="url(https://stackedit.io/app#arrowhead5768)" style="fill:none"></path><defs><marker id="arrowhead5768" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-C" style="opacity: 1;" id="L-E-C"><path class="path" d="M469.20684193255255,151.93749999999997L519.60546875,176.4375L519.60546875,201.4375" marker-end="url(https://stackedit.io/app#arrowhead5769)" style="fill:none"></path><defs><marker id="arrowhead5769" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-F" style="opacity: 1;" id="L-B-F"><path class="path" d="M239.96875,248.15625L239.96875,286.515625L239.96875,324.875" marker-end="url(https://stackedit.io/app#arrowhead5770)" style="fill:none"></path><defs><marker id="arrowhead5770" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-G" style="opacity: 1;" id="L-C-G"><path class="path" d="M519.60546875,248.15625L519.60546875,286.515625L519.60546875,324.875" marker-end="url(https://stackedit.io/app#arrowhead5771)" style="fill:none"></path><defs><marker id="arrowhead5771" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-H" style="opacity: 1;" id="L-F-H"><path class="path" d="M239.96875,371.59375L239.96875,396.59375L334.13191639741524,422.09375000000006" marker-end="url(https://stackedit.io/app#arrowhead5772)" style="fill:none"></path><defs><marker id="arrowhead5772" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-H" style="opacity: 1;" id="L-G-H"><path class="path" d="M519.60546875,371.59375L519.60546875,396.59375L469.2068419325524,422.09375000000006" marker-end="url(https://stackedit.io/app#arrowhead5773)" style="fill:none"></path><defs><marker id="arrowhead5773" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-I" style="opacity: 1;" id="L-H-I"><path class="path" d="M367.27431764240504,468.8125L277.484375,506.671875L277.484375,545.03125" marker-end="url(https://stackedit.io/app#arrowhead5774)" style="fill:none"></path><defs><marker id="arrowhead5774" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-J" style="opacity: 1;" id="L-I-J"><path class="path" d="M277.484375,591.75L277.484375,630.109375L277.484375,668.46875" marker-end="url(https://stackedit.io/app#arrowhead5775)" style="fill:none"></path><defs><marker id="arrowhead5775" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-J LE-K" style="opacity: 1;" id="L-J-K"><path class="path" d="M277.484375,715.1875L277.484375,740.1875L202.40625,770.5028029191128" marker-end="url(https://stackedit.io/app#arrowhead5776)" style="fill:none"></path><defs><marker id="arrowhead5776" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-K" style="opacity: 1;" id="L-D-K"><path class="path" d="M37.953125,715.1875L37.953125,740.1875L113.03125,770.5028029191128" marker-end="url(https://stackedit.io/app#arrowhead5777)" style="fill:none"></path><defs><marker id="arrowhead5777" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-L" style="opacity: 1;" id="L-H-L"><path class="path" d="M476.02255735759485,468.8125L564.8125,506.671875L564.8125,545.03125" marker-end="url(https://stackedit.io/app#arrowhead5778)" style="fill:none"></path><defs><marker id="arrowhead5778" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-L LE-M" style="opacity: 1;" id="L-L-M"><path class="path" d="M564.8125,591.75L564.8125,630.109375L564.8125,668.46875" marker-end="url(https://stackedit.io/app#arrowhead5779)" style="fill:none"></path><defs><marker id="arrowhead5779" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-D" class="edgeLabel L-LS-A' L-LE-D"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-E" class="edgeLabel L-LS-A' L-LE-E"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-B" class="edgeLabel L-LS-E' L-LE-B"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-C" class="edgeLabel L-LS-E' L-LE-C"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(239.96875,286.515625)"><g transform="translate(-104.8203125,-13.359375)" class="label"><rect rx="0" ry="0" width="209.640625" height="26.71875"></rect><foreignObject width="209.640625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-F" class="edgeLabel L-LS-B' L-LE-F">Take first and last timestamp</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(519.60546875,286.515625)"><g transform="translate(-42.625,-13.359375)" class="label"><rect rx="0" ry="0" width="85.25" height="26.71875"></rect><foreignObject width="85.25" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-G" class="edgeLabel L-LS-C' L-LE-G">Index x1000</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-H" class="edgeLabel L-LS-F' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-H" class="edgeLabel L-LS-G' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(277.484375,506.671875)"><g transform="translate(-100.828125,-13.359375)" class="label"><rect rx="0" ry="0" width="201.65625" height="26.71875"></rect><foreignObject width="201.65625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-I" class="edgeLabel L-LS-H' L-LE-I">Take time of this timestamp</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(277.484375,630.109375)"><g transform="translate(-84.5390625,-13.359375)" class="label"><rect rx="0" ry="0" width="169.078125" height="26.71875"></rect><foreignObject width="169.078125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-I-J" class="edgeLabel L-LS-I' L-LE-J">Convert to HH:MM:SS:ff</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-J-K" class="edgeLabel L-LS-J' L-LE-K"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-K" class="edgeLabel L-LS-D' L-LE-K"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(564.8125,506.671875)"><g transform="translate(-67.546875,-13.359375)" class="label"><rect rx="0" ry="0" width="135.09375" height="26.71875"></rect><foreignObject width="135.09375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-L" class="edgeLabel L-LS-H' L-LE-L">Save original index</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-L-M" class="edgeLabel L-LS-L' L-LE-M"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" style="opacity: 1;" id="flowchart-A-57652" transform="translate(301.3828125,31.359375)"><polygon points="-15.572916666666666,0 146.60416666666666,0 169.96354166666666,-46.71875 7.786458333333333,-46.71875" transform="translate(-77.1953125,23.359375)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-67.1953125,-13.359375)"><foreignObject width="134.390625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Make file variables</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-57653" transform="translate(239.96875,224.796875)"><rect rx="0" ry="0" x="-34.234375" y="-23.359375" width="68.46875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-24.234375,-13.359375)"><foreignObject width="48.46875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">ADC df</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-57654" transform="translate(519.60546875,224.796875)"><rect rx="0" ry="0" x="-98.421875" y="-23.359375" width="196.84375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-88.421875,-13.359375)"><foreignObject width="176.84375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Pointgrey Timestamps df</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-D-57655" transform="translate(37.953125,691.828125)"><rect rx="0" ry="0" x="-29.953125" y="-23.359375" width="59.90625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-19.953125,-13.359375)"><foreignObject width="39.90625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Video</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-57656" transform="translate(421.1484375,128.078125)"><polygon points="-15.572916666666666,0 136.52604166666666,0 159.88541666666666,-46.71875 7.786458333333333,-46.71875" transform="translate(-72.15625,23.359375)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-62.15625,-13.359375)"><foreignObject width="124.3125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Read data into df</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-F-57657" transform="translate(239.96875,348.234375)"><rect rx="0" ry="0" x="-129.5" y="-23.359375" width="259" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-119.5,-13.359375)"><foreignObject width="239" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">List with first and last timestamp</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G-57658" transform="translate(519.60546875,348.234375)"><rect rx="0" ry="0" x="-17.4140625" y="-23.359375" width="34.828125" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-7.4140625,-13.359375)"><foreignObject width="14.828125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">df</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-H-57659" transform="translate(421.1484375,444.953125)"><polygon points="-15.572916666666666,0 241.58854166666666,0 264.9479166666667,-46.71875 7.786458333333333,-46.71875" transform="translate(-124.6875,23.359375)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-114.6875,-13.359375)"><foreignObject width="229.375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Find closest index to timestamp</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-I-57660" transform="translate(277.484375,568.390625)"><rect rx="0" ry="0" x="-143.2578125" y="-23.359375" width="286.515625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-133.2578125,-13.359375)"><foreignObject width="266.515625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Start and End time of trial &lt;seconds&gt;</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-J-57661" transform="translate(277.484375,691.828125)"><rect rx="0" ry="0" x="-159.578125" y="-23.359375" width="319.15625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-149.578125,-13.359375)"><foreignObject width="299.15625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Start and End time of trial &lt;HH:MM:SS:ff&gt;</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-K-57662" transform="translate(157.71875,788.546875)"><rect rx="0" ry="0" x="-44.6875" y="-23.359375" width="89.375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-34.6875,-13.359375)"><foreignObject width="69.375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cut Video</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-L-57685" transform="translate(564.8125,568.390625)"><rect rx="0" ry="0" x="-29.4296875" y="-23.359375" width="58.859375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-19.4296875,-13.359375)"><foreignObject width="38.859375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Index</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-M-57687" transform="translate(564.8125,691.828125)"><rect rx="0" ry="0" x="-77.75" y="-23.359375" width="155.5" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-67.75,-13.359375)"><foreignObject width="135.5" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Align tracking data</div></foreignObject></g></g></g></g></g></g></svg></pre>
<h3 id="synchronization-with-tracker">synchronization with tracker</h3>
<p>An example for trial 1:</p>
<pre class=" language-mermaid"><svg id="mermaid-svg-FUmi5GJF3RRF0gmx" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="1661.0609130859375" style="max-width: 788.69921875px;" viewBox="0 0 788.69921875 1661.0609130859375"><style>#mermaid-svg-FUmi5GJF3RRF0gmx{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-FUmi5GJF3RRF0gmx .error-icon{fill:#552222;}#mermaid-svg-FUmi5GJF3RRF0gmx .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-FUmi5GJF3RRF0gmx .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-FUmi5GJF3RRF0gmx .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-FUmi5GJF3RRF0gmx .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-FUmi5GJF3RRF0gmx .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-FUmi5GJF3RRF0gmx .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-FUmi5GJF3RRF0gmx .marker{fill:#666;stroke:#666;}#mermaid-svg-FUmi5GJF3RRF0gmx .marker.cross{stroke:#666;}#mermaid-svg-FUmi5GJF3RRF0gmx svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-FUmi5GJF3RRF0gmx .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-FUmi5GJF3RRF0gmx .cluster-label text{fill:#333;}#mermaid-svg-FUmi5GJF3RRF0gmx .cluster-label span{color:#333;}#mermaid-svg-FUmi5GJF3RRF0gmx .label text,#mermaid-svg-FUmi5GJF3RRF0gmx span{fill:#000000;color:#000000;}#mermaid-svg-FUmi5GJF3RRF0gmx .node rect,#mermaid-svg-FUmi5GJF3RRF0gmx .node circle,#mermaid-svg-FUmi5GJF3RRF0gmx .node ellipse,#mermaid-svg-FUmi5GJF3RRF0gmx .node polygon,#mermaid-svg-FUmi5GJF3RRF0gmx .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-FUmi5GJF3RRF0gmx .node .label{text-align:center;}#mermaid-svg-FUmi5GJF3RRF0gmx .node.clickable{cursor:pointer;}#mermaid-svg-FUmi5GJF3RRF0gmx .arrowheadPath{fill:#333333;}#mermaid-svg-FUmi5GJF3RRF0gmx .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-FUmi5GJF3RRF0gmx .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-FUmi5GJF3RRF0gmx .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-FUmi5GJF3RRF0gmx .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-FUmi5GJF3RRF0gmx .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-FUmi5GJF3RRF0gmx .cluster text{fill:#333;}#mermaid-svg-FUmi5GJF3RRF0gmx .cluster span{color:#333;}#mermaid-svg-FUmi5GJF3RRF0gmx div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-FUmi5GJF3RRF0gmx:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-FUmi5GJF3RRF0gmx flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-D" style="opacity: 1;" id="L-A-D"><path class="path" d="M279.01075368915446,51.73889911583171L148.1015625,79.71875L148.1015625,104.71875" marker-end="url(https://stackedit.io/app#arrowhead5780)" style="fill:none"></path><defs><marker id="arrowhead5780" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" style="opacity: 1;" id="L-D-E"><path class="path" d="M148.1015625,151.4375L148.1015625,189.796875L148.1015625,228.15625" marker-end="url(https://stackedit.io/app#arrowhead5781)" style="fill:none"></path><defs><marker id="arrowhead5781" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"><path class="path" d="M442.27476403449907,49.565045091809196L566.8359375,79.71875L566.8359375,128.078125L566.8359375,189.796875L566.8359375,251.515625L566.8359375,313.234375L566.8359375,374.953125L566.8359375,436.671875L566.8359375,498.390625L566.8359375,546.75L566.8359375,622.0148468017578" marker-end="url(https://stackedit.io/app#arrowhead5782)" style="fill:none"></path><defs><marker id="arrowhead5782" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" style="opacity: 1;" id="L-A-C"><path class="path" d="M370.0390625,55.21875L369.5390625,79.71875L369.5390625,128.078125L369.5390625,189.796875L369.5390625,251.515625L369.5390625,313.234375L369.5390625,351.59375" marker-end="url(https://stackedit.io/app#arrowhead5783)" style="fill:none"></path><defs><marker id="arrowhead5783" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-C1" style="opacity: 1;" id="L-C-C1"><path class="path" d="M369.5390625,398.3125L369.5390625,436.671875L369.5390625,475.03125" marker-end="url(https://stackedit.io/app#arrowhead5784)" style="fill:none"></path><defs><marker id="arrowhead5784" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-C3" style="opacity: 1;" id="L-C-C3"><path class="path" d="M456.1328125,389.85624846822066L728.15234375,436.671875L728.15234375,498.390625L728.15234375,546.75L728.15234375,645.3742218017578L728.15234375,757.3578186035156L728.15234375,819.0765686035156L728.15234375,880.7953186035156L728.15234375,942.5140686035156L728.15234375,1004.2328186035156L728.15234375,1065.9515686035156L728.15234375,1127.6703186035156L728.15234375,1189.3890686035156L728.15234375,1251.1078186035156L728.15234375,1289.4671936035156" marker-end="url(https://stackedit.io/app#arrowhead5785)" style="fill:none"></path><defs><marker id="arrowhead5785" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-F" style="opacity: 1;" id="L-B-F"><path class="path" d="M566.8359375,668.7335968017578L566.8359375,757.3578186035156L566.8359375,795.7171936035156" marker-end="url(https://stackedit.io/app#arrowhead5786)" style="fill:none"></path><defs><marker id="arrowhead5786" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C1 LE-G" style="opacity: 1;" id="L-C1-G"><path class="path" d="M369.5390625,521.75L369.5390625,546.75L369.5390625,622.0148468017578" marker-end="url(https://stackedit.io/app#arrowhead5787)" style="fill:none"></path><defs><marker id="arrowhead5787" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-H" style="opacity: 1;" id="L-E-H"><path class="path" d="M148.1015625,274.875L148.1015625,313.234375L148.1015625,351.59375" marker-end="url(https://stackedit.io/app#arrowhead5788)" style="fill:none"></path><defs><marker id="arrowhead5788" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-I" style="opacity: 1;" id="L-H-I"><path class="path" d="M148.1015625,398.3125L148.1015625,436.671875L148.1015625,475.03125" marker-end="url(https://stackedit.io/app#arrowhead5789)" style="fill:none"></path><defs><marker id="arrowhead5789" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-J" style="opacity: 1;" id="L-I-J"><path class="path" d="M148.1015625,521.75L148.1015625,546.75L148.6015625,572.2500030517579" marker-end="url(https://stackedit.io/app#arrowhead5790)" style="fill:none"></path><defs><marker id="arrowhead5790" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-J LE-K" style="opacity: 1;" id="L-J-K"><path class="path" d="M148.6015625,719.4984344482424L148.1015625,757.3578186035156L216.91536787974684,795.7171936035156" marker-end="url(https://stackedit.io/app#arrowhead5791)" style="fill:none"></path><defs><marker id="arrowhead5791" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-K" style="opacity: 1;" id="L-G-K"><path class="path" d="M369.5390625,668.7335968017578L369.5390625,757.3578186035156L300.72525712025316,795.7171936035156" marker-end="url(https://stackedit.io/app#arrowhead5792)" style="fill:none"></path><defs><marker id="arrowhead5792" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-K LE-L" style="opacity: 1;" id="L-K-L"><path class="path" d="M258.8203125,842.4359436035156L258.8203125,880.7953186035156L322.35120648734176,919.1546936035156" marker-end="url(https://stackedit.io/app#arrowhead5793)" style="fill:none"></path><defs><marker id="arrowhead5793" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-L" style="opacity: 1;" id="L-F-L"><path class="path" d="M566.8359375,842.4359436035156L566.8359375,880.7953186035156L438.9292721518987,919.1546936035156" marker-end="url(https://stackedit.io/app#arrowhead5794)" style="fill:none"></path><defs><marker id="arrowhead5794" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-L LE-M" style="opacity: 1;" id="L-L-M"><path class="path" d="M361.0390625,965.8734436035156L361.0390625,1004.2328186035156L361.0390625,1042.5921936035156" marker-end="url(https://stackedit.io/app#arrowhead5795)" style="fill:none"></path><defs><marker id="arrowhead5795" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-M LE-N" style="opacity: 1;" id="L-M-N"><path class="path" d="M361.0390625,1089.3109436035156L361.0390625,1127.6703186035156L361.0390625,1166.0296936035156" marker-end="url(https://stackedit.io/app#arrowhead5796)" style="fill:none"></path><defs><marker id="arrowhead5796" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-N LE-O" style="opacity: 1;" id="L-N-O"><path class="path" d="M361.0390625,1212.7484436035156L361.0390625,1251.1078186035156L361.0390625,1289.4671936035156" marker-end="url(https://stackedit.io/app#arrowhead5797)" style="fill:none"></path><defs><marker id="arrowhead5797" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-O LE-P" style="opacity: 1;" id="L-O-P"><path class="path" d="M361.0390625,1336.1859436035156L361.0390625,1361.1859436035156L411.67920789579966,1386.1859436035156" marker-end="url(https://stackedit.io/app#arrowhead5798)" style="fill:none"></path><defs><marker id="arrowhead5798" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C3 LE-P" style="opacity: 1;" id="L-C3-P"><path class="path" d="M728.15234375,1336.1859436035156L728.15234375,1361.1859436035156L554.07421875,1392.4626066056635" marker-end="url(https://stackedit.io/app#arrowhead5799)" style="fill:none"></path><defs><marker id="arrowhead5799" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-P LE-Q" style="opacity: 1;" id="L-P-Q"><path class="path" d="M458.99609375,1432.9046936035156L458.99609375,1471.2640686035156L458.99609375,1509.6234436035156" marker-end="url(https://stackedit.io/app#arrowhead5800)" style="fill:none"></path><defs><marker id="arrowhead5800" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-Q LE-R" style="opacity: 1;" id="L-Q-R"><path class="path" d="M458.99609375,1556.3421936035156L458.99609375,1581.3421936035156L458.99609375,1606.3421936035156" marker-end="url(https://stackedit.io/app#arrowhead5801)" style="fill:none"></path><defs><marker id="arrowhead5801" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-D" class="edgeLabel L-LS-A' L-LE-D"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(148.1015625,189.796875)"><g transform="translate(-111.90625,-13.359375)" class="label"><rect rx="0" ry="0" width="223.8125" height="26.71875"></rect><foreignObject width="223.8125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-E" class="edgeLabel L-LS-D' L-LE-E">Cut video at 00:44:00 - 1:05:00</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(566.8359375,313.234375)"><g transform="translate(-77.2890625,-13.359375)" class="label"><rect rx="0" ry="0" width="154.578125" height="26.71875"></rect><foreignObject width="154.578125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B">Read into Dataframes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(369.5390625,189.796875)"><g transform="translate(-77.2890625,-13.359375)" class="label"><rect rx="0" ry="0" width="154.578125" height="26.71875"></rect><foreignObject width="154.578125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C">Read into Dataframes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-C1" class="edgeLabel L-LS-C' L-LE-C1"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-C3" class="edgeLabel L-LS-C' L-LE-C3"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(566.8359375,757.3578186035156)"><g transform="translate(-44.7890625,-13.359375)" class="label"><rect rx="0" ry="0" width="89.578125" height="26.71875"></rect><foreignObject width="89.578125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-F" class="edgeLabel L-LS-B' L-LE-F">Downsample</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C1-G" class="edgeLabel L-LS-C1' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(148.1015625,313.234375)"><g transform="translate(-46.609375,-13.359375)" class="label"><rect rx="0" ry="0" width="93.21875" height="26.71875"></rect><foreignObject width="93.21875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-H" class="edgeLabel L-LS-E' L-LE-H">Track subclip</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(148.1015625,436.671875)"><g transform="translate(-116.3203125,-13.359375)" class="label"><rect rx="0" ry="0" width="232.640625" height="26.71875"></rect><foreignObject width="232.640625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-I" class="edgeLabel L-LS-H' L-LE-I">Find long high likelihood periods</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-I-J" class="edgeLabel L-LS-I' L-LE-J"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(148.1015625,757.3578186035156)"><g transform="translate(-100.71875,-13.359375)" class="label"><rect rx="0" ry="0" width="201.4375" height="26.71875"></rect><foreignObject width="201.4375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-J-K" class="edgeLabel L-LS-J' L-LE-K">find led signal using indexes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(369.5390625,757.3578186035156)"><g transform="translate(-100.71875,-13.359375)" class="label"><rect rx="0" ry="0" width="201.4375" height="26.71875"></rect><foreignObject width="201.4375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-K" class="edgeLabel L-LS-G' L-LE-K">find led signal using indexes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(258.8203125,880.7953186035156)"><g transform="translate(-60.59375,-13.359375)" class="label"><rect rx="0" ry="0" width="121.1875" height="26.71875"></rect><foreignObject width="121.1875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-K-L" class="edgeLabel L-LS-K' L-LE-L">Cross correlation</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(566.8359375,880.7953186035156)"><g transform="translate(-60.59375,-13.359375)" class="label"><rect rx="0" ry="0" width="121.1875" height="26.71875"></rect><foreignObject width="121.1875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-L" class="edgeLabel L-LS-F' L-LE-L">Cross correlation</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(361.0390625,1004.2328186035156)"><g transform="translate(-135.328125,-13.359375)" class="label"><rect rx="0" ry="0" width="270.65625" height="26.71875"></rect><foreignObject width="270.65625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-L-M" class="edgeLabel L-LS-L' L-LE-M">save in dict &amp; change index with shift</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(361.0390625,1127.6703186035156)"><g transform="translate(-71.2734375,-13.359375)" class="label"><rect rx="0" ry="0" width="142.546875" height="26.71875"></rect><foreignObject width="142.546875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-M-N" class="edgeLabel L-LS-M' L-LE-N">turn into dataframe</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(361.0390625,1251.1078186035156)"><g transform="translate(-123.2578125,-13.359375)" class="label"><rect rx="0" ry="0" width="246.515625" height="26.71875"></rect><foreignObject width="246.515625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-N-O" class="edgeLabel L-LS-N' L-LE-O">Select trial with lowest E-distance</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-O-P" class="edgeLabel L-LS-O' L-LE-P"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C3-P" class="edgeLabel L-LS-C3' L-LE-P"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(458.99609375,1471.2640686035156)"><g transform="translate(-83.71875,-13.359375)" class="label"><rect rx="0" ry="0" width="167.4375" height="26.71875"></rect><foreignObject width="167.4375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-P-Q" class="edgeLabel L-LS-P' L-LE-Q">convert to HH:MM:SS:ff</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-Q-R" class="edgeLabel L-LS-Q' L-LE-R"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" style="opacity: 1;" id="flowchart-A-57745" transform="translate(369.5390625,31.359375)"><polygon points="-15.572916666666666,0 146.60416666666666,0 169.96354166666666,-46.71875 7.786458333333333,-46.71875" transform="translate(-77.1953125,23.359375)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-67.1953125,-13.359375)"><foreignObject width="134.390625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Make file variables</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-57746" transform="translate(566.8359375,645.3742218017578)"><rect rx="0" ry="0" x="-79.78125" y="-23.359375" width="159.5625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-69.78125,-13.359375)"><foreignObject width="139.5625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">ADC LED dataframe</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-57747" transform="translate(369.5390625,374.953125)"><rect rx="0" ry="0" x="-86.59375" y="-23.359375" width="173.1875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-76.59375,-13.359375)"><foreignObject width="153.1875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Pointgrey dataframes</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-D-57748" transform="translate(148.1015625,128.078125)"><rect rx="0" ry="0" x="-29.953125" y="-23.359375" width="59.90625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-19.953125,-13.359375)"><foreignObject width="39.90625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Video</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-57749" transform="translate(148.1015625,251.515625)"><rect rx="0" ry="0" x="-57.484375" y="-23.359375" width="114.96875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-47.484375,-13.359375)"><foreignObject width="94.96875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Video subclip</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-F-57750" transform="translate(566.8359375,819.0765686035156)"><rect rx="0" ry="0" x="-91.71875" y="-23.359375" width="183.4375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.71875,-13.359375)"><foreignObject width="163.4375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Downsampled ADC LED</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G-57751" transform="translate(369.5390625,645.3742218017578)"><rect rx="0" ry="0" x="-60.375" y="-23.359375" width="120.75" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-50.375,-13.359375)"><foreignObject width="100.75" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Binary PG LED</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-H-57752" transform="translate(148.1015625,374.953125)"><rect rx="0" ry="0" x="-58.1875" y="-23.359375" width="116.375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48.1875,-13.359375)"><foreignObject width="96.375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Tracking data</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-I-57753" transform="translate(148.1015625,498.390625)"><rect rx="0" ry="0" x="-140.1015625" y="-23.359375" width="280.203125" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-130.1015625,-13.359375)"><foreignObject width="260.203125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Dict with start/stop index of 2 trials</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-J-57754" transform="translate(148.1015625,645.3742218017578)"><polygon points="73.62421875,0 147.2484375,-73.62421875 73.62421875,-147.2484375 0,-73.62421875" transform="translate(-73.62421875,73.62421875)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-48.4453125,-13.359375)"><foreignObject width="96.890625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">For each trial</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-K-57755" transform="translate(258.8203125,819.0765686035156)"><rect rx="0" ry="0" x="-62.71875" y="-23.359375" width="125.4375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-52.71875,-13.359375)"><foreignObject width="105.4375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">LED PG of trial</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-L-57756" transform="translate(361.0390625,942.5140686035156)"><rect rx="0" ry="0" x="-99.8515625" y="-23.359375" width="199.703125" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-89.8515625,-13.359375)"><foreignObject width="179.703125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Lag &amp; Euclidean distance</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C1-57757" transform="translate(369.5390625,498.390625)"><rect rx="0" ry="0" x="-23.2421875" y="-23.359375" width="46.484375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-13.2421875,-13.359375)"><foreignObject width="26.484375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">LED</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C3-57758" transform="translate(728.15234375,1312.8265686035156)"><rect rx="0" ry="0" x="-52.546875" y="-23.359375" width="105.09375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-42.546875,-13.359375)"><foreignObject width="85.09375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Timestamps</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-M-57759" transform="translate(361.0390625,1065.9515686035156)"><rect rx="0" ry="0" x="-148.3125" y="-23.359375" width="296.625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-138.3125,-13.359375)"><foreignObject width="276.625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Dict with index and cc results per trial</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-N-57760" transform="translate(361.0390625,1189.3890686035156)"><rect rx="0" ry="0" x="-143.09375" y="-23.359375" width="286.1875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-133.09375,-13.359375)"><foreignObject width="266.1875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">DF with index and cc results per trial</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-O-57761" transform="translate(361.0390625,1312.8265686035156)"><rect rx="0" ry="0" x="-93.3671875" y="-23.359375" width="186.734375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-83.3671875,-13.359375)"><foreignObject width="166.734375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">start/end index of trial</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-P-57762" transform="translate(458.99609375,1409.5453186035156)"><rect rx="0" ry="0" x="-95.078125" y="-23.359375" width="190.15625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-85.078125,-13.359375)"><foreignObject width="170.15625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Get timestamp of index</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-Q-57799" transform="translate(458.99609375,1532.9828186035156)"><rect rx="0" ry="0" x="-86" y="-23.359375" width="172" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-76,-13.359375)"><foreignObject width="152" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">start/end Timestamp</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-R-57801" transform="translate(458.99609375,1629.7015686035156)"><rect rx="0" ry="0" x="-44.0546875" y="-23.359375" width="88.109375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-34.0546875,-13.359375)"><foreignObject width="68.109375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cut video</div></foreignObject></g></g></g></g></g></g></svg></pre>
<h3 id="code-for-functions-in-flowcharts">Code for functions in flowcharts:</h3>
<h4 id="make-file-variables">Make file variables</h4>
<pre><code>ADC_file = ADC_loc+'/100_ADC'+ADC+'_0.continuous'

Pointgrey_files = make_pg_files(date_serial)
FRAME_file = Pointgrey_files[0]
TIME_file = Pointgrey_files[1]
LED_file = Pointgrey_files[2]
VIDEO_file = Pointgrey_files[3]
</code></pre>
<h4 id="read-into-dataframe">Read into dataframe</h4>
<pre><code># load in data as dataframes

# loading of ADC using openEphys.py
data = load(file_path+ADC_file)
DF_ADC_samples, DF_ADC_timestamps = load_data_into_dataframe(data)

# Reading in of the Pointgrey files
DF_p_frames = pd.read_csv(file_path+FRAME_file, header=None)
DF_p_timestamps = pd.read_csv(file_path+TIME_file, header=None)
DF_p_led = pd.read_csv(file_path+LED_file, header=None)

# conversion of binary timestamps to seconds
DF_p_timestamps = convert_and_uncycle_timestamps(DF_p_timestamps)
DF_p_timestamps = DF_p_timestamps.apply(lambda x : x - DF_p_timestamps[0][0])
</code></pre>
<h4 id="downsample-function">Downsample (function)</h4>
<pre><code>def  downsample_ADC_led(DF_ADC_samples):
	DF_ADC_samples.rename(columns={0  :  'value'}, inplace=True)
	DF_ADC_samples['state'] = 0
	DF_ADC_samples.loc[DF_ADC_samples.value.between(0,1),  'state'] = 0
	DF_ADC_samples.loc[DF_ADC_samples.value.between(1,5),  'state'] = 1

	group_size = 1000
	lst = [DF_ADC_samples.iloc[i:i+group_size]  for i in  range(0,len(DF_ADC_samples)-group_size+1,group_size)]
	downsampled = []
	for df in lst:
		m = df["state"].iloc[-1]
		downsampled.append(m)
	downsampled_DF = pd.DataFrame(downsampled)

return downsampled_DF
</code></pre>
<h4 id="index-x-1000--taking-first-and-last-timestamp">Index x 1000 &amp; taking first and last timestamp</h4>
<pre><code># find the starting timestamp and stopping timestamp in the continuous files
s = DF_ADC_timestamps[0][0]
st = DF_ADC_timestamps.iloc[-1][0]

# multiply this number by 1000 to make it comparable to
# the continuous timestamps
# (continuous file timestamps are sample numbers)
DF_p_timestamps['index1'] = DF_p_timestamps.index*1000
</code></pre>
<h4 id="find-closest-value-to-index">Find Closest value to index</h4>
<pre><code>c_s = DF_p_timestamps.iloc[(DF_p_timestamps['index1']-s).abs().argsort()[:1]].index.tolist()
c_st = DF_p_timestamps.iloc[(DF_p_timestamps['index1']-st).abs().argsort()[:1]].index.tolist()
</code></pre>
<h4 id="conversion-s-to-hhmmssff">Conversion s to HH:MM:SS:ff</h4>
<pre><code>start = pd.to_datetime(DF_p_timestamps[0].iloc[c_s[0]+phase], unit='s').strftime('%H:%M:%S.%f')
stop = pd.to_datetime(DF_p_timestamps[0].iloc[c_st[0]+phase], unit='s').strftime('%H:%M:%S.%f')
</code></pre>
<h4 id="cutting-video-for-subclip">Cutting video for subclip</h4>
<pre><code>b = DF_p_timestamps.loc[DF_p_timestamps[0] &gt; 2650]
e = b.loc[b[0] &gt; 3900]

begin= b.iloc[1][0]
end= e.iloc[1][0]

start= pd.to_datetime(begin, unit='s').strftime('%H:%M:%S.%f')
stop= pd.to_datetime(end, unit='s').strftime('%H:%M:%S.%f')
cut(video_file_path=file_path+VIDEO_file, start_time= start, end_time=stop)
</code></pre>
<h4 id="cut-function">Cut (function)</h4>
<pre><code>def  cut(video_file_path, start_time, end_time):
	""" 
	cuts the video using ffmpeg using the start and end time and the video
	Keyword arguments:
	video_file_path -- full path to the video
	start_time -- string of time in HH:MM:SS:ff format
	end_time -- string of time in HH:MM:SS:ff format
	"""
	output_file_path = re.search("^[\/].+\/", video_file_path)
	output_file_path_raw = output_file_path.group(0)
	delsplit = re.search("\/(?:.(?!\/))+$", video_file_path)
	filename = re.sub("^[\/]",  "", delsplit.group(0))
	filename_raw = re.sub(".{4}$",  "", filename)
	file_extension = re.search(".{3}$", filename)
	file_extension_raw = file_extension.group(0)

	os.environ['inputFile'] = video_file_path
	os.environ['outputPath'] = output_file_path_raw
	os.environ['startTime'] = start_time
	os.environ['endTime'] = end_time
	os.environ['fileName'] = filename_raw
	os.environ['fileExtension'] = file_extension_raw

	!ffmpeg -hide_banner -i "$inputFile" -ss "$startTime" -to "$endTime" -c copy "$outputPath"/"$fileName"-TRIM."$fileExtension"
</code></pre>
<h4 id="tracking-of-subclip">Tracking of subclip</h4>
<pre><code>ProjectFolderName = 'Stage/downsampled_tracker-sanne-2021-09-16'
VideoType = 'avi'
path_config_file = '/content/drive/My Drive/'+ProjectFolderName+'/config.yaml'
t_video = file_path+VIDEO_file
t_video = t_video.replace('.avi',  '-TRIM.avi')
deeplabcut.analyze_videos(path_config_file, t_video, save_as_csv=True)
</code></pre>
<h4 id="finding-periods-of-high-likelihood">Finding periods of high likelihood</h4>
<pre><code>DLCscorer='DLC_resnet50_downsampled_trackerSep16shuffle1_322500'
a_file = t_video.replace('.avi', DLCscorer+'.h5')
#loading output of DLC
Dataframe = pd.read_hdf(a_file)
df = Dataframe['DLC_resnet50_downsampled_trackerSep16shuffle1_322500']['Head']['likelihood'].to_frame()

trials = {}
# Find all values that have a small difference between -0.25 and 0.25 as well as a likelihood above 0.99
# then groupby to only find this pattern consecutivly and count it up
x = df[(df['likelihood'].diff().between(-0.25,0.25))&amp;(df['likelihood'].between(0.99,1.0))].groupby(((~df['likelihood'].diff().between(-0.25,0.25))&amp; (~df['likelihood'].between(0.99,1.0))).cumsum())

# for all the newly made groups with the previous criteria only keep the longest ones
# as these should correlate with the trials
for k, v in x:
	if  len(v) &gt; 1000:
		trials[k] = [v.index[1], v.index[-1]]
</code></pre>
<h4 id="correcting-index--saving">Correcting Index &amp; saving</h4>
<pre><code># k = group number, v = list with start and stop
# y = index value
# b = cut index value

num = 0
trial_dic = {}

for k, v in trials.items():
	num = num+1
	trial_dic[num] = []
	for y in v:
		trial_dic[num].append(y+b_index)
</code></pre>
<h4 id="binarizing-led">Binarizing LED</h4>
<pre><code>DF_p_led.rename(columns={0:  'value'}, inplace=True)
DF_p_led['state'] = 0
DF_p_led.loc[DF_p_led['value'] &lt;= 500,  'state'] = 0
DF_p_led.loc[DF_p_led['value'] &gt; 500,  'state'] = 1
</code></pre>
<h4 id="for-loop-cross-correlation">For loop Cross correlation</h4>
<pre><code>for k in trial_dic.keys():
	whole = DF_p_led.state.iloc[trial_dic[k][0]: trial_dic[k][1]].to_numpy()
	trial = DF_ADC_Led[0].to_numpy()
	shift,e_distance = compare_and_plot_signals_with_alignment(whole, trial, bshift_method = 'all', pad_function = pad_zeros_right)
	print(len(whole)-len(trial))
	trial_dic[k][0] = trial_dic[k][0] + shift
	trial_dic[k][1] = trial_dic[k][1] + shift + abs(len(whole)-len(trial))
	trial_dic[k].append(shift)
	trial_dic[k].append(e_distance)
	# value connected to key now looks like : [start index, end index, shift, elucedian distance]
</code></pre>
<h4 id="correction-with-cross-correlation-results">Correction with cross correlation results</h4>
<pre><code>df = pd.DataFrame.from_dict(trial_dic, orient='index',
columns=['begin','end','shift',  'elucidean distance'])
correct_trial_index = df['elucidean distance'].idxmin()
begin_shift = DF_p_timestamps.iloc[trial_dic[correct_trial_index][0]].values
end_shift = DF_p_timestamps.iloc[trial_dic[correct_trial_index][1]].values
start= pd.to_datetime(begin_shift[0], unit='s').strftime('%H:%M:%S.%f')
stop= pd.to_datetime(end_shift[0], unit='s').strftime('%H:%M:%S.%f')

cut(video_file_path=file_path+VIDEO_file, start_time= start, end_time=stop)
</code></pre>
<h2 id="extraction">Extraction</h2>
<p>cuts the video using ffmpeg using the start and end time and the video<br>
Keyword arguments:<br>
video_file_path – full path to the video<br>
start_time – string of time in HH:MM:SS:ff format<br>
end_time – string of time in HH:MM:SS:ff format<br>
trial – string that looks like “trial#”</p>
<pre><code>import os, re

def  cut(video_file_path, start_time, end_time,trial):
	output_file_path = re.search("^[\/].+\/", video_file_path)
	output_file_path_raw = output_file_path.group(0)
	delsplit = re.search("\/(?:.(?!\/))+$", video_file_path)
	filename = re.sub("^[\/]",  "", delsplit.group(0))
	filename_raw = re.sub(".{4}$",  "", filename)
	file_extension = re.search(".{3}$", filename)
	file_extension_raw = file_extension.group(0)
	# turn into os environment variables (so we can use them in the command like $variable)
	os.environ['inputFile'] = video_file_path
	os.environ['outputPath'] = output_file_path_raw
	os.environ['startTime'] = start_time
	os.environ['endTime'] = end_time
	os.environ['fileName'] = filename_raw
	os.environ['fileExtension'] = file_extension_raw
	os.environ['trial'] = trial
	!ffmpeg -hide_banner -i "$inputFile" -ss "$startTime" -to "$endTime" -c copy "$outputPath"/"$fileName""$trial"-TRIM."$fileExtension"
</code></pre>
<h2 id="tracking--analysis">Tracking &amp; Analysis</h2>
<h3 id="how-to-setup-and-use-a-dlc-project">How to setup and use a DLC project:</h3>
<ol>
<li>Install Deeplabcut (<a href="https://github.com/DeepLabCut/DeepLabCut/blob/master/docs/installation.md">Documentation on this here</a>)
<ul>
<li>It’s possible you’ll run into this error <code>failed build due to wxPython</code> An explanation on how to solve this can be found <a href="https://deeplabcut.github.io/DeepLabCut/docs/recipes/installTips.html">here</a></li>
<li>There is also a possibility that you will need to download a wheel to get it working on linux/ubuntu (information on this is mentioned in the deeplabcut documentation.</li>
</ul>
</li>
<li>Start the env <code>conda activate DEEPLABCUT</code></li>
<li>Click on create project
<ul>
<li>Add the videos you want to label</li>
<li>No need to change settings</li>
</ul>
</li>
<li>Now open the config file created
<ul>
<li>Fill in the bodyparts you want to track under ‘bodyparts:’</li>
<li>Fill in the skeleton connections that would be usefull to you under ‘skeleton:’ <code>- -</code> in front of the body part 1 and then <code>-</code> in front of the body part you want to connect to body part 1</li>
</ul>
</li>
<li>Now you can extract frames from the videos
<ul>
<li>You can extract them manually (which is best but takes time) if you do so make sure to add a diverse selection, many similair frames will not improve the tracker.</li>
<li>You can also simply extract them normally (there is settings in the config file for how many frames per video will be extracted <code>numframes2pick:</code>)</li>
</ul>
</li>
<li>Now you can label these frames in the label frame tab
<ul>
<li>with left click you can remove a point you put</li>
</ul>
</li>
<li>Once you have labeled everything we can move the project into colab
<ul>
<li>Copy paste the entire directory onto your google drive</li>
</ul>
</li>
<li>Create a training dataset</li>
<li>Start training
<ul>
<li>The more itterations the better we should aim for around 200k+ to 500k</li>
<li>Basically go on till the loss stabelizes for a long time(this is given every itteration)</li>
<li>There is files called <code>pose_cfg.yaml</code> inside the <code>dlc_models</code> directory inside these there are loads of parameters you can change around. (none of this is necessary but some might give better results)</li>
</ul>
</li>
<li>Evaluate model
<ul>
<li>You’ll get a pixel error, the lower the better we hope to see a number like 2 to 8 in there. the lower the better</li>
</ul>
</li>
<li>If its good enough then you can start using the model for analysis and make labeled videos
<ul>
<li>however if the result isnt good enough then either add more images or continue training for more itterations
<ul>
<li>click <a href="https://forum.image.sc/t/is-it-possible-to-re-train-from-snapshot-with-new-labeled-frames/44574/9">here</a> for a forum post on how to retrain your model and start from a snapshot(previous itteration of your model)</li>
</ul>
</li>
</ul>
</li>
<li>Analyze videos and create plots
<ul>
<li>in these plots you can see for instance the likelihood, and the trajectory. If this is not what you expected (very low likelhood) you can take this video and put it in for relabeling in the GUI, this will then be added to the training set after you’ve relabeled. Then you can train the model again to adapt to this video.</li>
</ul>
</li>
</ol>
<h3 id="analysis">Analysis</h3>
<h4 id="neuron-analysis">Neuron analysis</h4>
<pre class=" language-mermaid"><svg id="mermaid-svg-toro5AmBpMiha9jm" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="996.78125" style="max-width: 957.2421875px;" viewBox="0 0 957.2421875 996.78125"><style>#mermaid-svg-toro5AmBpMiha9jm{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-toro5AmBpMiha9jm .error-icon{fill:#552222;}#mermaid-svg-toro5AmBpMiha9jm .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-toro5AmBpMiha9jm .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-toro5AmBpMiha9jm .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-toro5AmBpMiha9jm .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-toro5AmBpMiha9jm .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-toro5AmBpMiha9jm .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-toro5AmBpMiha9jm .marker{fill:#666;stroke:#666;}#mermaid-svg-toro5AmBpMiha9jm .marker.cross{stroke:#666;}#mermaid-svg-toro5AmBpMiha9jm svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-toro5AmBpMiha9jm .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-toro5AmBpMiha9jm .cluster-label text{fill:#333;}#mermaid-svg-toro5AmBpMiha9jm .cluster-label span{color:#333;}#mermaid-svg-toro5AmBpMiha9jm .label text,#mermaid-svg-toro5AmBpMiha9jm span{fill:#000000;color:#000000;}#mermaid-svg-toro5AmBpMiha9jm .node rect,#mermaid-svg-toro5AmBpMiha9jm .node circle,#mermaid-svg-toro5AmBpMiha9jm .node ellipse,#mermaid-svg-toro5AmBpMiha9jm .node polygon,#mermaid-svg-toro5AmBpMiha9jm .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-toro5AmBpMiha9jm .node .label{text-align:center;}#mermaid-svg-toro5AmBpMiha9jm .node.clickable{cursor:pointer;}#mermaid-svg-toro5AmBpMiha9jm .arrowheadPath{fill:#333333;}#mermaid-svg-toro5AmBpMiha9jm .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-toro5AmBpMiha9jm .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-toro5AmBpMiha9jm .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-toro5AmBpMiha9jm .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-toro5AmBpMiha9jm .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-toro5AmBpMiha9jm .cluster text{fill:#333;}#mermaid-svg-toro5AmBpMiha9jm .cluster span{color:#333;}#mermaid-svg-toro5AmBpMiha9jm div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-toro5AmBpMiha9jm:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-toro5AmBpMiha9jm flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-B LE-C" style="opacity: 1;" id="L-B-C"><path class="path" d="M531.6875,54.71875L531.6875,93.078125L531.6875,131.4375" marker-end="url(https://stackedit.io/app#arrowhead5802)" style="fill:none"></path><defs><marker id="arrowhead5802" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" style="opacity: 1;" id="L-C-D"><path class="path" d="M531.6875,178.15625L531.6875,216.515625L624.6677116297468,254.875" marker-end="url(https://stackedit.io/app#arrowhead5803)" style="fill:none"></path><defs><marker id="arrowhead5803" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-D" style="opacity: 1;" id="L-E-D"><path class="path" d="M830.890625,178.15625L830.890625,216.515625L737.9104133702532,254.875" marker-end="url(https://stackedit.io/app#arrowhead5804)" style="fill:none"></path><defs><marker id="arrowhead5804" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-F" style="opacity: 1;" id="L-A-F"><path class="path" d="M325.6640625,294.48212171285167L488.5078125,339.953125L556.9720134493671,378.3125" marker-end="url(https://stackedit.io/app#arrowhead5805)" style="fill:none"></path><defs><marker id="arrowhead5805" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-F" style="opacity: 1;" id="L-D-F"><path class="path" d="M681.2890625,301.59375L681.2890625,339.953125L629.9360561708861,378.3125" marker-end="url(https://stackedit.io/app#arrowhead5806)" style="fill:none"></path><defs><marker id="arrowhead5806" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-G" style="opacity: 1;" id="L-F-G"><path class="path" d="M598.6640625,425.03125L598.6640625,463.390625L572.4024574762658,501.75" marker-end="url(https://stackedit.io/app#arrowhead5807)" style="fill:none"></path><defs><marker id="arrowhead5807" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-H" style="opacity: 1;" id="L-G-H"><path class="path" d="M556.41015625,548.46875L556.41015625,586.828125L556.41015625,648.546875L556.41015625,696.90625L463.9889123081583,721.90625" marker-end="url(https://stackedit.io/app#arrowhead5808)" style="fill:none"></path><defs><marker id="arrowhead5808" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-I" style="opacity: 1;" id="L-H-I"><path class="path" d="M377.6328125,768.625L377.6328125,806.984375L377.6328125,845.34375" marker-end="url(https://stackedit.io/app#arrowhead5809)" style="fill:none"></path><defs><marker id="arrowhead5809" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-J" style="opacity: 1;" id="L-I-J"><path class="path" d="M377.6328125,892.0625L377.6328125,917.0625L377.6328125,942.0625" marker-end="url(https://stackedit.io/app#arrowhead5810)" style="fill:none"></path><defs><marker id="arrowhead5810" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-K" style="opacity: 1;" id="L-A-K"><path class="path" d="M233.61433939873416,301.59375L178.0078125,339.953125L178.0078125,378.3125" marker-end="url(https://stackedit.io/app#arrowhead5811)" style="fill:none"></path><defs><marker id="arrowhead5811" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-K LE-G" style="opacity: 1;" id="L-K-G"><path class="path" d="M245.6716426028481,425.03125L356.78515625,463.390625L480.8558840981013,501.75" marker-end="url(https://stackedit.io/app#arrowhead5812)" style="fill:none"></path><defs><marker id="arrowhead5812" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-K LE-L" style="opacity: 1;" id="L-K-L"><path class="path" d="M165.92598892405064,425.03125L146.0859375,463.390625L146.0859375,501.75" marker-end="url(https://stackedit.io/app#arrowhead5813)" style="fill:none"></path><defs><marker id="arrowhead5813" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-L LE-M" style="opacity: 1;" id="L-L-M"><path class="path" d="M146.0859375,548.46875L146.0859375,586.828125L146.0859375,625.1875" marker-end="url(https://stackedit.io/app#arrowhead5814)" style="fill:none"></path><defs><marker id="arrowhead5814" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-M LE-H" style="opacity: 1;" id="L-M-H"><path class="path" d="M146.0859375,671.90625L146.0859375,696.90625L265.7870683562197,721.90625" marker-end="url(https://stackedit.io/app#arrowhead5815)" style="fill:none"></path><defs><marker id="arrowhead5815" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(531.6875,93.078125)"><g transform="translate(-131.2265625,-13.359375)" class="label"><rect rx="0" ry="0" width="262.453125" height="26.71875"></rect><foreignObject width="262.453125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-C" class="edgeLabel L-LS-B' L-LE-C">Divide by 30k 'conversion  to seconds'</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(531.6875,216.515625)"><g transform="translate(-118.3515625,-13.359375)" class="label"><rect rx="0" ry="0" width="236.703125" height="26.71875"></rect><foreignObject width="236.703125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-D" class="edgeLabel L-LS-C' L-LE-D">Find closest matching timestamp</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(830.890625,216.515625)"><g transform="translate(-118.3515625,-13.359375)" class="label"><rect rx="0" ry="0" width="236.703125" height="26.71875"></rect><foreignObject width="236.703125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-D" class="edgeLabel L-LS-E' L-LE-D">Find closest matching timestamp</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(488.5078125,339.953125)"><g transform="translate(-72.625,-13.359375)" class="label"><rect rx="0" ry="0" width="145.25" height="26.71875"></rect><foreignObject width="145.25" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-F" class="edgeLabel L-LS-A' L-LE-F">Find matching index</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(681.2890625,339.953125)"><g transform="translate(-72.625,-13.359375)" class="label"><rect rx="0" ry="0" width="145.25" height="26.71875"></rect><foreignObject width="145.25" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-F" class="edgeLabel L-LS-D' L-LE-F">Find matching index</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(598.6640625,463.390625)"><g transform="translate(-64.5078125,-13.359375)" class="label"><rect rx="0" ry="0" width="129.015625" height="26.71875"></rect><foreignObject width="129.015625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-G" class="edgeLabel L-LS-F' L-LE-G">kmeans clustering</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(556.41015625,648.546875)"><g transform="translate(-214.7109375,-13.359375)" class="label"><rect rx="0" ry="0" width="429.421875" height="26.71875"></rect><foreignObject width="429.421875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-H" class="edgeLabel L-LS-G' L-LE-H">total time spent in cluster/total amount of spikes in cluster</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(377.6328125,806.984375)"><g transform="translate(-55.0703125,-13.359375)" class="label"><rect rx="0" ry="0" width="110.140625" height="26.71875"></rect><foreignObject width="110.140625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-I" class="edgeLabel L-LS-H' L-LE-I">Collect all data</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-I-J" class="edgeLabel L-LS-I' L-LE-J"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(178.0078125,339.953125)"><g transform="translate(-86.3125,-13.359375)" class="label"><rect rx="0" ry="0" width="172.625" height="26.71875"></rect><foreignObject width="172.625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-K" class="edgeLabel L-LS-A' L-LE-K">Create Kmeans algoritm</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-K-G" class="edgeLabel L-LS-K' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(146.0859375,463.390625)"><g transform="translate(-43.84375,-13.359375)" class="label"><rect rx="0" ry="0" width="87.6875" height="26.71875"></rect><foreignObject width="87.6875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-K-L" class="edgeLabel L-LS-K' L-LE-L">Cluster data</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(146.0859375,586.828125)"><g transform="translate(-138.0859375,-13.359375)" class="label"><rect rx="0" ry="0" width="276.171875" height="26.71875"></rect><foreignObject width="276.171875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-L-M" class="edgeLabel L-LS-L' L-LE-M">amount of data points in cluster*0.033</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-M-H" class="edgeLabel L-LS-M' L-LE-H"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" style="opacity: 1;" id="flowchart-A-57836" transform="translate(267.4765625,278.234375)"><rect rx="0" ry="0" x="-58.1875" y="-23.359375" width="116.375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48.1875,-13.359375)"><foreignObject width="96.375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Tracking data</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-57837" transform="translate(531.6875,31.359375)"><rect rx="0" ry="0" x="-100.4296875" y="-23.359375" width="200.859375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-90.4296875,-13.359375)"><foreignObject width="180.859375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Neuron data 'timestamps'</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-57838" transform="translate(531.6875,154.796875)"><rect rx="0" ry="0" x="-139.671875" y="-23.359375" width="279.34375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-129.671875,-13.359375)"><foreignObject width="259.34375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Converted Neuron data 'timestamps'</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-D-57839" transform="translate(681.2890625,278.234375)"><rect rx="0" ry="0" x="-112.125" y="-23.359375" width="224.25" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-102.125,-13.359375)"><foreignObject width="204.25" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Matching timestamp indexes</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-57840" transform="translate(830.890625,154.796875)"><rect rx="0" ry="0" x="-109.53125" y="-23.359375" width="219.0625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-99.53125,-13.359375)"><foreignObject width="199.0625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Trial timestamps 'PointGrey'</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-F-57841" transform="translate(598.6640625,401.671875)"><rect rx="0" ry="0" x="-73.140625" y="-23.359375" width="146.28125" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-63.140625,-13.359375)"><foreignObject width="126.28125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Spike coordinates</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G-57842" transform="translate(556.41015625,525.109375)"><rect rx="0" ry="0" x="-109.15625" y="-23.359375" width="218.3125" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-99.15625,-13.359375)"><foreignObject width="198.3125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Clustered spike coordinates</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-H-57843" transform="translate(377.6328125,745.265625)"><rect rx="0" ry="0" x="-122.28125" y="-23.359375" width="244.5625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-112.28125,-13.359375)"><foreignObject width="224.5625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Clusters with spikes per second</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-I-57857" transform="translate(377.6328125,868.703125)"><rect rx="0" ry="0" x="-120.1328125" y="-23.359375" width="240.265625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-110.1328125,-13.359375)"><foreignObject width="220.265625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">dict with all neurons and trials</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-J-57859" transform="translate(377.6328125,965.421875)"><rect rx="0" ry="0" x="-87.046875" y="-23.359375" width="174.09375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-77.046875,-13.359375)"><foreignObject width="154.09375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Graphs of all Neurons</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-K-57861" transform="translate(178.0078125,401.671875)"><rect rx="0" ry="0" x="-120.734375" y="-23.359375" width="241.46875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-110.734375,-13.359375)"><foreignObject width="221.46875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">kmeans clusters on trial 1 data</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-L-57865" transform="translate(146.0859375,525.109375)"><rect rx="0" ry="0" x="-88.375" y="-23.359375" width="176.75" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.375,-13.359375)"><foreignObject width="156.75" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Clustered coordinates</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-M-57867" transform="translate(146.0859375,648.546875)"><rect rx="0" ry="0" x="-107.84375" y="-23.359375" width="215.6875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-97.84375,-13.359375)"><foreignObject width="195.6875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Total time spent in clusters</div></foreignObject></g></g></g></g></g></g></svg></pre>
<pre><code>def  Neuron_Analysis(ADC_loc,kmeans, path,df_xy,n_clusters, Trial1_times):
	
	mat = 'R3SD3_{}'.format(ADC_loc)
	mat_fname = path+ADC_loc+'/R3SD3_{}.mat'.format(ADC_loc)
	pred = kmeans.predict(df_xy[['x',  'y']])
	frame = pd.DataFrame(df_xy)

	# add what coordinate set belongs to what cluster
	frame['cluster'] = pred

	# find how many data points are in each cluster
	total_frame = frame['cluster'].value_counts()

	# calculate time by taking that 1 point is 1 frame and 1 frame = 0.033s
	total_frame = total_frame.apply(lambda x: x * 0.033)

	# centroids in necessary or just wanna check
	centroids = kmeans.cluster_centers_

	# show a scatter plot of the clusters and trajectory with centroids
	plot = plt.scatter(frame['x'], frame['y'],
						c=frame['cluster'],
						s=50,
						alpha=0.5,
						cmap='Set2')
	plot = gaussian_filter(plot, sigma=50)
	plt.title('Kmeans clusters on trajectory of {}'.format(ADC_loc))
	plt.gca().invert_yaxis()
	plt.colorbar()
	plt.scatter(centroids[:,  0], centroids[:,  1], c='red', s=50)
	plt.show()

	# setting up the mat file
	mat_contents = sio.loadmat(mat_fname)

	# receive the subset of the trial timestamp data
	print(mat_fname)

	# make original index into column incase its needed
	Trial1_times['full_index'] = Trial1_times.index

	# reset the index so it starts from 0
	Trial1_times = Trial1_times.reset_index(drop=True)
	neur = 0
	neur_dic = {}

	#fig, axarr = plt.subplots(4, 5, sharex=True, sharey=True)
	for ar in mat_contents[mat][0]:
		neur = neur + 1
		neuron1 = ar

	if  len(neuron1) &gt; 1:
		neuron1_conv = [number / 30000  for number in neuron1]
		neuron1_conv_c = []

		# connect them into one array
		for l in neuron1_conv:
			neuron1_conv_c.extend(l)

		# getting the indexes of the spikes accorind to the trial video
		spike_indexes = []
		for n in neuron1_conv_c:
			x = Trial1_times.iloc[(
			Trial1_times[0]-n).abs().argsort()[:1]].index.tolist()
			if x[0] != 0:
			spike_indexes.append(x[0])

		# finding the corresponding x and y coordinates
		x_list = []
		y_list = []

		for n in spike_indexes:
			#x = df_xy['x'].iloc[n]
			x_list.append(df_xy['x'].iloc[n])
			y_list.append(df_xy['y'].iloc[n])

		# combine the lists
		data_tuples = list(zip(x_list, y_list))
		df_xy_neurons = pd.DataFrame(data_tuples, columns=['x',  'y'])


		if  len(df_xy_neurons) &gt; 0:
			# predict in which cluster each coordinate set belongs
			pred = kmeans.predict(df_xy_neurons)
			frame = pd.DataFrame(df_xy_neurons)

			# add the cluster data to each coordinate set
			frame['clusters'] = pred
			neuron_frame = frame['clusters'].value_counts()
			neuron_frame = pd.concat([neuron_frame, total_frame], axis=1)

			# calculate the spikes per second by:
			# amount of spikes in cluster /time spent in cluster
			neuron_frame['Result'] = neuron_frame['clusters']/neuron_frame['cluster']

			# value is the value which will be assigned to each cluster based on the
			# last calculation
			frame['value'] = np.NaN
			# each cluster gets its spikes per second value which will decide the
			# color in the graph
			for i in  range(n_clusters):
				frame.loc[frame.clusters == i,  'value'] = neuron_frame.iloc[i]['Result']
				neur_dic[neur] = frame
			
return neur_dic, total_frame
</code></pre>
<h4 id="speed">Speed</h4>
<pre class=" language-mermaid"><svg id="mermaid-svg-V8tokYYL8r3iMHEW" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="873.34375" style="max-width: 526.5px;" viewBox="0 0 526.5 873.34375"><style>#mermaid-svg-V8tokYYL8r3iMHEW{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-V8tokYYL8r3iMHEW .error-icon{fill:#552222;}#mermaid-svg-V8tokYYL8r3iMHEW .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-V8tokYYL8r3iMHEW .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-V8tokYYL8r3iMHEW .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-V8tokYYL8r3iMHEW .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-V8tokYYL8r3iMHEW .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-V8tokYYL8r3iMHEW .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-V8tokYYL8r3iMHEW .marker{fill:#666;stroke:#666;}#mermaid-svg-V8tokYYL8r3iMHEW .marker.cross{stroke:#666;}#mermaid-svg-V8tokYYL8r3iMHEW svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-V8tokYYL8r3iMHEW .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-V8tokYYL8r3iMHEW .cluster-label text{fill:#333;}#mermaid-svg-V8tokYYL8r3iMHEW .cluster-label span{color:#333;}#mermaid-svg-V8tokYYL8r3iMHEW .label text,#mermaid-svg-V8tokYYL8r3iMHEW span{fill:#000000;color:#000000;}#mermaid-svg-V8tokYYL8r3iMHEW .node rect,#mermaid-svg-V8tokYYL8r3iMHEW .node circle,#mermaid-svg-V8tokYYL8r3iMHEW .node ellipse,#mermaid-svg-V8tokYYL8r3iMHEW .node polygon,#mermaid-svg-V8tokYYL8r3iMHEW .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-V8tokYYL8r3iMHEW .node .label{text-align:center;}#mermaid-svg-V8tokYYL8r3iMHEW .node.clickable{cursor:pointer;}#mermaid-svg-V8tokYYL8r3iMHEW .arrowheadPath{fill:#333333;}#mermaid-svg-V8tokYYL8r3iMHEW .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-V8tokYYL8r3iMHEW .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-V8tokYYL8r3iMHEW .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-V8tokYYL8r3iMHEW .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-V8tokYYL8r3iMHEW .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-V8tokYYL8r3iMHEW .cluster text{fill:#333;}#mermaid-svg-V8tokYYL8r3iMHEW .cluster span{color:#333;}#mermaid-svg-V8tokYYL8r3iMHEW div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-V8tokYYL8r3iMHEW:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-V8tokYYL8r3iMHEW flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"><path class="path" d="M263.25,54.71875L263.25,93.078125L263.25,131.4375" marker-end="url(https://stackedit.io/app#arrowhead5816)" style="fill:none"></path><defs><marker id="arrowhead5816" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" style="opacity: 1;" id="L-B-C"><path class="path" d="M263.25,178.15625L263.25,216.515625L263.25,254.875" marker-end="url(https://stackedit.io/app#arrowhead5817)" style="fill:none"></path><defs><marker id="arrowhead5817" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" style="opacity: 1;" id="L-C-D"><path class="path" d="M308.114784414557,301.59375L381.7890625,339.953125L381.7890625,378.3125" marker-end="url(https://stackedit.io/app#arrowhead5818)" style="fill:none"></path><defs><marker id="arrowhead5818" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" style="opacity: 1;" id="L-D-E"><path class="path" d="M381.7890625,425.03125L381.7890625,463.390625L381.7890625,501.75" marker-end="url(https://stackedit.io/app#arrowhead5819)" style="fill:none"></path><defs><marker id="arrowhead5819" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-F" style="opacity: 1;" id="L-C-F"><path class="path" d="M218.38521558544304,301.59375L144.7109375,339.953125L144.7109375,401.671875L144.7109375,463.390625L144.7109375,501.75" marker-end="url(https://stackedit.io/app#arrowhead5820)" style="fill:none"></path><defs><marker id="arrowhead5820" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-G" style="opacity: 1;" id="L-F-G"><path class="path" d="M144.7109375,548.46875L144.7109375,573.46875L205.99122829159936,598.46875" marker-end="url(https://stackedit.io/app#arrowhead5821)" style="fill:none"></path><defs><marker id="arrowhead5821" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-G" style="opacity: 1;" id="L-E-G"><path class="path" d="M381.7890625,548.46875L381.7890625,573.46875L320.5087717084007,598.46875" marker-end="url(https://stackedit.io/app#arrowhead5822)" style="fill:none"></path><defs><marker id="arrowhead5822" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-H" style="opacity: 1;" id="L-G-H"><path class="path" d="M290.32765526107596,645.1875L334.79296875,683.546875L334.79296875,721.90625" marker-end="url(https://stackedit.io/app#arrowhead5823)" style="fill:none"></path><defs><marker id="arrowhead5823" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-I" style="opacity: 1;" id="L-G-I"><path class="path" d="M236.17234473892404,645.1875L191.70703125,683.546875L191.70703125,745.265625L191.70703125,793.625L228.69208779281098,818.625" marker-end="url(https://stackedit.io/app#arrowhead5824)" style="fill:none"></path><defs><marker id="arrowhead5824" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-I" style="opacity: 1;" id="L-H-I"><path class="path" d="M334.79296875,768.625L334.79296875,793.625L297.807912207189,818.625" marker-end="url(https://stackedit.io/app#arrowhead5825)" style="fill:none"></path><defs><marker id="arrowhead5825" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(263.25,93.078125)"><g transform="translate(-58.421875,-13.359375)" class="label"><rect rx="0" ry="0" width="116.84375" height="26.71875"></rect><foreignObject width="116.84375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B">take headsubset</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(263.25,216.515625)"><g transform="translate(-210.890625,-13.359375)" class="label"><rect rx="0" ry="0" width="421.78125" height="26.71875"></rect><foreignObject width="421.78125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-C" class="edgeLabel L-LS-B' L-LE-C">take out data where the difference is larger than 10 pixels</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(381.7890625,339.953125)"><g transform="translate(-61.453125,-13.359375)" class="label"><rect rx="0" ry="0" width="122.90625" height="26.71875"></rect><foreignObject width="122.90625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-D" class="edgeLabel L-LS-C' L-LE-D">calulate distance</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(381.7890625,463.390625)"><g transform="translate(-78.1875,-13.359375)" class="label"><rect rx="0" ry="0" width="156.375" height="26.71875"></rect><foreignObject width="156.375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-E" class="edgeLabel L-LS-D' L-LE-E">distance/time =speed</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(144.7109375,401.671875)"><g transform="translate(-101.046875,-13.359375)" class="label"><rect rx="0" ry="0" width="202.09375" height="26.71875"></rect><foreignObject width="202.09375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-F" class="edgeLabel L-LS-C' L-LE-F">calculate average likelihood</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-G" class="edgeLabel L-LS-F' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-G" class="edgeLabel L-LS-E' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(334.79296875,683.546875)"><g transform="translate(-123.0859375,-13.359375)" class="label"><rect rx="0" ry="0" width="246.171875" height="26.71875"></rect><foreignObject width="246.171875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-H" class="edgeLabel L-LS-G' L-LE-H">'optional' filter by 0.999 likelihood</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-I" class="edgeLabel L-LS-G' L-LE-I"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-I" class="edgeLabel L-LS-H' L-LE-I"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" style="opacity: 1;" id="flowchart-A-57892" transform="translate(263.25,31.359375)"><rect rx="0" ry="0" x="-58.1875" y="-23.359375" width="116.375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48.1875,-13.359375)"><foreignObject width="96.375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Tracking data</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-57893" transform="translate(263.25,154.796875)"><rect rx="0" ry="0" x="-53.5078125" y="-23.359375" width="107.015625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-43.5078125,-13.359375)"><foreignObject width="87.015625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Head subset</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-57894" transform="translate(263.25,278.234375)"><rect rx="0" ry="0" x="-82.96875" y="-23.359375" width="165.9375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72.96875,-13.359375)"><foreignObject width="145.9375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Outlier filtered data</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-D-57895" transform="translate(381.7890625,401.671875)"><rect rx="0" ry="0" x="-101.03125" y="-23.359375" width="202.0625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-91.03125,-13.359375)"><foreignObject width="182.0625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">data with distance added</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-57896" transform="translate(381.7890625,525.109375)"><rect rx="0" ry="0" x="-91.859375" y="-23.359375" width="183.71875" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.859375,-13.359375)"><foreignObject width="163.71875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">data with speed added</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-F-57905" transform="translate(144.7109375,525.109375)"><rect rx="0" ry="0" x="-75.6796875" y="-23.359375" width="151.359375" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-65.6796875,-13.359375)"><foreignObject width="131.359375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">average likelihood</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G-57908" transform="translate(263.25,621.828125)"><rect rx="0" ry="0" x="-255.25" y="-23.359375" width="510.5" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-245.25,-13.359375)"><foreignObject width="490.5" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Dataframe with coordinates, distance, speed and average likelihood</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-H-57910" transform="translate(334.79296875,745.265625)"><rect rx="0" ry="0" x="-55.5078125" y="-23.359375" width="111.015625" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-45.5078125,-13.359375)"><foreignObject width="91.015625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">filtered data</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-I-57913" transform="translate(263.25,841.984375)"><rect rx="0" ry="0" x="-110" y="-23.359375" width="220" height="46.71875" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-100,-13.359375)"><foreignObject width="200" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Create files and plot results</div></foreignObject></g></g></g></g></g></g></svg></pre>
<pre class=" language-import"><code class="prism  language-import">import pandas as pd
from pathlib import Path
import numpy as np
import os
import matplotlib.pyplot as plt

def  calculateDistance(x1,y1,x2,y2):
	dist = math.sqrt((x2 - x1)**2 + (y2 - y1)**2)
	return dist
	
def  calculateSpeed(video, scorer, likelihood_filter):
	%matplotlib inline
	
	file = video.replace('.avi', scorer+'.h5')
	#loading output of DLC
	Dataframe = pd.read_hdf(file)
	
	#Getting data of the head
	head_x = Dataframe['DLC_resnet50_downsampled_trackerSep16shuffle1_322500']['Head']['x']
	head_y = Dataframe['DLC_resnet50_downsampled_trackerSep16shuffle1_322500']['Head']['y']
	head_l = Dataframe['DLC_resnet50_downsampled_trackerSep16shuffle1_322500']['Head']['likelihood']
	
	speed_list = []
	
	head_x[(head_x.diff() &gt; 10) | (head_x.diff() &lt; -10)] = np.nan
	head_x = head_x.fillna(method='ffill')
	head_y[(head_y.diff() &gt; 10) | (head_y.diff() &lt; -10)] = np.nan
	head_y = head_y.fillna(method='ffill')
	
	#calculate speed by calculating distance of rat between frames
	#then using the distance to calculate the speed
	for i in  range(len(Dataframe)-1):
		x1 = head_x[i]
		x2 = head_x[i+1]
		y1 = head_y[i]
		y2 = head_y[i+1]
		l1 = head_l[i]
		l2 = head_l[i+1]
		speed = calculateDistance(x1,y1,x2,y2)/0.033  #*0.2645833333)/10 (in case of conversion to cm)
		av_l = (l1+l2)/2
		
		#saving the data in the format
		#xy1 = x coordinate frame 1 -- y coordinate frame 1
		#xy2 = x coordinate frame 2 -- y coordinate frame 2
		#likelihood = average of likelihood between these frames
		#speed = speed calculated with distance xy1 and xy2 and time of 0.033 sec
		speed_list.append(['{x1}-{y1}'.format(x1=x1,y1=y1),'{x1}-{y1}'.format(x1=x2,y1=y2), av_l, speed])
	df = pd.DataFrame(speed_list, columns=['xy1','xy2','likelihood','speed'])
	
	#filter to only keep above 0.99 likelihood
	df.speed[df.likelihood &lt; 0.999] = 0
	
	#Write to files
	df.to_csv('xy_likelihood_speed.csv')
	df.speed.to_csv('speed.txt', index=False)
	ax = df.speed.plot(title='Speed of rat during trial')
	ax.set(xlabel='frame numbers', ylabel='speed in (cm/s)')
	
	#Plot graph
	plt.show()
	
	return df
</code></pre>
</div>
</body>

</html>
